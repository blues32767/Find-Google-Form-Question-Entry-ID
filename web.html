  <html>
  <head>
      <title>Google表單預填答案網址產生+欄位(entry)ID查詢工具 Google Forms Pre-fill URL Generator & Entry ID Finder</title>
      <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
      <style>
        
            textarea.answer-input {
                min-height: 100px;
                resize: vertical;
                line-height: 1.5;
                white-space: pre-wrap;
            }

            .radio-group, .checkbox-group {
                display: flex;
                flex-direction: column;
                gap: 8px;
                padding: 8px 0;
            }

            .radio-option, .checkbox-option {
                display: flex;
                align-items: center;
                gap: 8px;
            }

            .radio-option label, .checkbox-option label {
                cursor: pointer;
            }

            input[type="radio"], input[type="checkbox"] {
                cursor: pointer;
                width: 16px;
                height: 16px;
            }

          * {
              box-sizing: border-box;
              font-family: 'Noto Sans TC', sans-serif;
              margin: 0;
              padding: 0;
          }
          
          body {
              max-width: 1200px;
              margin: 0 auto;
              padding: 40px 20px;
              background-color: #f8f9fa;
              color: #202124;
              line-height: 1.6;
          }
          
          .header {
              text-align: center;
              margin-bottom: 40px;
              padding: 20px;
              background: linear-gradient(135deg, #1a73e8 0%, #4285f4 100%);
              border-radius: 16px;
              box-shadow: 0 4px 12px rgba(0,0,0,0.1);
              color: white;
          }
          
          .header h1 {
              font-size: 2.2em;
              margin-bottom: 8px;
              font-weight: 700;
          }
          
          .header h4 {
              font-weight: 400;
              opacity: 0.9;
          }
          
          .input-container {
              background: white;
              padding: 24px;
              border-radius: 12px;
              box-shadow: 0 2px 8px rgba(0,0,0,0.08);
              margin-bottom: 24px;
              transition: transform 0.2s ease;
          }
          
          .input-container:hover {
              transform: translateY(-2px);
          }
          
          .input-group {
              display: flex;
              gap: 16px;
              align-items: center;
              flex-wrap: wrap;
          }
          
          .input-group label {
              font-weight: 500;
              color: #5f6368;
              min-width: 200px;
          }
          
          input[type="url"] {
              flex: 1;
              padding: 12px 16px;
              border: 2px solid #e0e0e0;
              border-radius: 8px;
              font-size: 16px;
              transition: all 0.3s ease;
              min-width: 300px;
          }
          
          input[type="url"]:focus {
              border-color: #1a73e8;
              box-shadow: 0 0 0 3px rgba(26,115,232,0.2);
              outline: none;
          }
          
          .search-button {
              background: #1a73e8;
              color: white;
              border: none;
              padding: 12px 24px;
              border-radius: 8px;
              cursor: pointer;
              font-weight: 500;
              font-size: 16px;
              transition: all 0.3s ease;
              display: flex;
              align-items: center;
              gap: 8px;
          }
          
          .search-button:hover {
              background: #1557b0;
              transform: translateY(-1px);
              box-shadow: 0 4px 12px rgba(26,115,232,0.3);
          }
          
          .search-button:active {
              transform: translateY(0);
          }
          
          .result-container {
              background: white;
              border-radius: 12px;
              box-shadow: 0 2px 8px rgba(0,0,0,0.08);
              overflow: hidden;
              margin-bottom: 24px;
          }
          
          table {
              width: 100%;
              border-collapse: collapse;
              background: white;
          }
          
          th {
              background-color: #f8f9fa;
              color: #202124;
              font-weight: 500;
              text-align: left;
              padding: 16px;
              border-bottom: 2px solid #e0e0e0;
          }
          
          td {
              padding: 16px;
              border-bottom: 1px solid #e0e0e0;
              vertical-align: middle;
          }
          
          tr:hover td {
              background-color: #f8f9fa;
          }
          
          .answer-input {
              width: 100%;
              padding: 10px 12px;
              border: 2px solid #e0e0e0;
              border-radius: 6px;
              font-size: 14px;
              transition: all 0.3s ease;
          }
          
          .answer-input:focus {
              border-color: #1a73e8;
              box-shadow: 0 0 0 3px rgba(26,115,232,0.2);
              outline: none;
          }
          
          .prefilled-url-container {
              background: white;
              padding: 24px;
              border-radius: 12px;
              box-shadow: 0 2px 8px rgba(0,0,0,0.08);
              margin-top: 24px;
          }
          
          .prefilled-url-container h3 {
              color: #202124;
              margin-bottom: 16px;
              font-size: 1.2em;
          }
          
          .prefilled-url {
              word-break: break-all;
              padding: 16px;
              background: #f8f9fa;
              border: 1px solid #e0e0e0;
              border-radius: 8px;
              margin: 12px 0;
              font-family: monospace;
              font-size: 14px;
              line-height: 1.5;
          }
          
          .copy-url-btn {
              background: #1a73e8;
              color: white;
              border: none;
              padding: 12px 24px;
              border-radius: 8px;
              cursor: pointer;
              font-weight: 500;
              transition: all 0.3s ease;
              display: inline-flex;
              align-items: center;
              gap: 8px;
          }
          
          .copy-url-btn:hover {
              background: #1557b0;
              transform: translateY(-1px);
              box-shadow: 0 4px 12px rgba(26,115,232,0.3);
          }
          
          .copy-notification {
              position: fixed;
              bottom: 24px;
              right: 24px;
              background-color: #323232;
              color: white;
              padding: 12px 24px;
              border-radius: 8px;
              display: none;
              animation: fadeInOut 2s ease-in-out;
              box-shadow: 0 4px 12px rgba(0,0,0,0.2);
          }
          
          footer {
              text-align: center;
              margin-top: 40px;
              padding: 24px;
              color: #5f6368;
              border-top: 1px solid #e0e0e0;
          }
          
          footer a {
              color: #1a73e8;
              text-decoration: none;
              transition: color 0.3s ease;
          }
          
          footer a:hover {
              color: #1557b0;
              text-decoration: underline;
          }
          
          @keyframes fadeInOut {
              0% { opacity: 0; transform: translateY(20px); }
              20% { opacity: 1; transform: translateY(0); }
              80% { opacity: 1; transform: translateY(0); }
              100% { opacity: 0; transform: translateY(-20px); }
          }
          
          /* 響應式設計 */
          @media (max-width: 768px) {
              body {
                  padding: 20px 16px;
              }
              
              .input-group {
                  flex-direction: column;
              }
              
              input[type="url"] {
                  width: 100%;
              }
              
              .search-button {
                  width: 100%;
                  justify-content: center;
              }
          }
     
     /* 在現有的style標籤內添加這些樣式 */
          .entry-id-cell {
              cursor: pointer;
              position: relative;
              user-select: all;
              background-color: #f8f9fa;
              border: 1px solid #e0e0e0;
              border-radius: 4px;
              padding: 8px 12px;
              font-family: monospace;
              transition: all 0.2s ease;
          }

          .entry-id-cell:hover {
              background-color: #e8f0fe;
              border-color: #1a73e8;
          }

          .entry-id-cell:active {
              background-color: #d2e3fc;
          }

          .entry-id-cell::after {
              content: "點擊複製";
              position: absolute;
              top: -30px;
              left: 50%;
              transform: translateX(-50%);
              background-color: #323232;
              color: white;
              padding: 4px 8px;
              border-radius: 4px;
              font-size: 12px;
              opacity: 0;
              transition: opacity 0.2s ease;
              pointer-events: none;
          }

          .entry-id-cell:hover::after {
              opacity: 1;
          }

          .copied::after {
              content: "已複製！" !important;
              background-color: #1a73e8 !important;
          }

          select.answer-input {
              appearance: none;
              -webkit-appearance: none;
              -moz-appearance: none;
              background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
              background-repeat: no-repeat;
              background-position: right 10px center;
              background-size: 1em;
              padding-right: 40px;
          }

          select.answer-input:focus {
              border-color: #1a73e8;
              box-shadow: 0 0 0 3px rgba(26,115,232,0.2);
          }

          select.answer-input option {
              padding: 8px;
              font-size: 14px;
          }
                  .grid-group {
                      border: 1px solid #e0e0e0;
                      border-radius: 8px;
                      padding: 16px;
                      margin-bottom: 8px;
                  }

                  .grid-row {
                      display: flex;
                      align-items: center;
                      margin-bottom: 12px;
                  }

                  .grid-row-label {
                      min-width: 150px;
                      font-weight: 500;
                  }

                  .grid-options {
                      display: flex;
                      gap: 16px;
                  }

                  .grid-option {
                      display: flex;
                      align-items: center;
                      gap: 4px;
                  }

                  .grid-option input {
                      margin: 0;
                  }

                  .grid-option label {
                      cursor: pointer;
                  }

                  .datetime-group,
                  .time-group {
                      display: flex;
                      gap: 12px;
                      align-items: center;
                  }

                  .time-container {
                      display: flex;
                      gap: 8px;
                      align-items: center;
                  }

                  .time-input {
                      width: 50px;
                      padding: 8px;
                      border: 2px solid #e0e0e0;
                      border-radius: 6px;
                      text-align: center;
                  }

                  .ampm-select {
                      padding: 8px;
                      border: 2px solid #e0e0e0;
                      border-radius: 6px;
                      background-color: white;
                  }

                  input[type="date"] {
                      padding: 8px;
                      border: 2px solid #e0e0e0;
                      border-radius: 6px;
                      font-family: inherit;
                  }

                  .time-input:focus,
                  .ampm-select:focus,
                  input[type="date"]:focus {
                      border-color: #1a73e8;
                      box-shadow: 0 0 0 3px rgba(26,115,232,0.2);
                      outline: none;
                  }

      </style>
  </head>
  <body>
      <div class="header">
          <h1>Google表單預填答案網址產生+欄位(entry)ID查詢工具</h1>
          <h4>Google Forms Pre-fill URL Generator & Entry ID Finder</h4>
      </div>

      <div class="input-container">
          <div class="input-group">
              <label for="formUrl">請輸入 Google 表單網址(Enter Googleforms Url)：</label>
              <input type="url" id="formUrl" name="formUrl" placeholder="https://docs.google.com/forms/...">
              <button onclick="查詢()" class="search-button">
                  <span>查詢　Find</span>
              </button>
          </div>
      </div>

      <div id="結果顯示區" class="result-container">
          <table id="fieldsTable" style="display:none">
              <thead>
                  <tr>
                      <th>使用者答案 Your Answer</th>
                      <th>欄位標題 Question Title</th>
                      <th>欄位 ID(entry) Question ID</th>
                      <th>必填欄位 Must Answer</th>
                  </tr>
              </thead>
              <tbody></tbody>
          </table>
      </div>

      <div id="prefilledUrlContainer" class="prefilled-url-container" style="display:none">
          <h3>預填網址 Auto-fill Link</h3>
          <div id="prefilledUrl" class="prefilled-url"></div>
          <button onclick="copyPrefilledUrl()" class="copy-url-btn">
              複製預填網址 Copy Auto-fill Link
          </button>
      </div>

      <div id="copyNotification" class="copy-notification">
          已複製到剪貼簿！ Copied
      </div>

      <footer>
          <p>
              © 2025 Google表單預填答案網址產生+欄位(entry)ID查詢工具<br>
              Google Forms Pre-fill URL Generator & Entry ID Finder<br>
              開發者 Developer ：<a href="https://github.com/blues32767" target="_blank">blues32767</a><br>
              <small>Version 1.0.0 | Last Updated: Taiwan 2025/02/19</small><br>
              ※如需要登入的Google表單無法使用；不支援日期、時間填寫。<br>
              ※Warning: Won't work with Google Forms that need login. Can't pre-fill dates and times.<br>
          </p>
      </footer>

      <script>
          let originalFormUrl = '';
          
          function 查詢() {
              var formUrl = document.getElementById("formUrl").value;
              if (!formUrl) {
                  alert("請輸入表單網址");
                  return;
              }
              originalFormUrl = formUrl;
              google.script.run
                  .withSuccessHandler(顯示欄位資訊)
                  .getFormFields(formUrl);
          }

          // 在web.html中的顯示欄位資訊函數
              function 顯示欄位資訊(fields) {
                  var table = document.getElementById("fieldsTable");
                  var tbody = table.getElementsByTagName("tbody")[0];
                  tbody.innerHTML = "";

                  if (Array.isArray(fields)) {
                      table.style.display = "table";
                      fields.forEach(function(field) {
                          var row = tbody.insertRow();
                          var answerCell = row.insertCell(0);
                          var titleCell = row.insertCell(1);
                          var idCell = row.insertCell(2);
                          var requiredCell = row.insertCell(3);
                          
                          // 根據欄位類型建立不同的輸入元素
                          let inputElement;
                          
                          switch(field.type) {
                              case 'PARAGRAPH':
                                  inputElement = document.createElement('textarea');
                                  inputElement.className = 'answer-input';
                                  inputElement.placeholder = '請輸入答案...';
                                  inputElement.rows = 4;
                                  break;
                                  
                              case 'RADIO':
                                  inputElement = document.createElement('div');
                                  inputElement.className = 'radio-group';
                                  field.options.forEach(option => {
                                      const wrapper = document.createElement('div');
                                      wrapper.className = 'radio-option';
                                      
                                      const radio = document.createElement('input');
                                      radio.type = 'radio';
                                      radio.name = 'entry.' + field.id;
                                      radio.value = option;
                                      radio.id = `radio-${field.id}-${option}`;
                                      
                                      const label = document.createElement('label');
                                      label.htmlFor = radio.id;
                                      label.textContent = option;
                                      
                                      wrapper.appendChild(radio);
                                      wrapper.appendChild(label);
                                      inputElement.appendChild(wrapper);
                                  });
                                  break;
                                  
                                case 'CHECKBOX':
                                    inputElement = document.createElement('div');
                                    inputElement.className = 'checkbox-group';
                                    inputElement.setAttribute('data-entry-id', 'entry.' + field.id); // 添加這行
                                    field.options.forEach(option => {
                                        const wrapper = document.createElement('div');
                                        wrapper.className = 'checkbox-option';
                                        
                                        const checkbox = document.createElement('input');
                                        checkbox.type = 'checkbox';
                                        checkbox.name = 'entry.' + field.id; // 添加這行
                                        checkbox.value = option;
                                        checkbox.id = `checkbox-${field.id}-${option}`;
                                        
                                        const label = document.createElement('label');
                                        label.htmlFor = checkbox.id;
                                        label.textContent = option;
                                        
                                        wrapper.appendChild(checkbox);
                                        wrapper.appendChild(label);
                                        inputElement.appendChild(wrapper);
                                        
                                        // 為每個checkbox添加change事件監聽器
                                        checkbox.addEventListener('change', updatePrefilledUrl);
                                    });
                                    break;


                              case 'LIST':
                                  inputElement = document.createElement('select');
                                  inputElement.className = 'answer-input';
                                  
                                  // 添加預設空選項
                                  let defaultOption = document.createElement('option');
                                  defaultOption.value = '';
                                  defaultOption.text = '請選擇...';
                                  defaultOption.disabled = field.required;
                                  defaultOption.selected = true;
                                  inputElement.appendChild(defaultOption);
                                  
                                  // 添加所有選項
                                  if (field.options) {
                                      field.options.forEach(option => {
                                          let optionElement = document.createElement('option');
                                          optionElement.value = option;
                                          optionElement.text = option;
                                          inputElement.appendChild(optionElement);
                                      });
                                  }
                                  break;

                                  case 'GRID': // 單選方格
                                      inputElement = document.createElement('div');
                                      inputElement.className = 'grid-group';
                                      field.rows.forEach(row => {
                                          const rowDiv = document.createElement('div');
                                          rowDiv.className = 'grid-row';
                                          
                                          const rowLabel = document.createElement('div');
                                          rowLabel.className = 'grid-row-label';
                                          rowLabel.textContent = row.title;
                                          rowDiv.appendChild(rowLabel);
                                          
                                          const optionsDiv = document.createElement('div');
                                          optionsDiv.className = 'grid-options';
                                          
                                          field.rows[0].options.forEach(option => {
                                              const wrapper = document.createElement('div');
                                              wrapper.className = 'grid-option';
                                              
                                              const radio = document.createElement('input');
                                              radio.type = 'radio';
                                              radio.name = 'entry.' + row.id;
                                              radio.value = option;
                                              radio.id = `grid-${row.id}-${option}`;
                                              
                                              const label = document.createElement('label');
                                              label.htmlFor = radio.id;
                                              label.textContent = option;
                                              
                                              wrapper.appendChild(radio);
                                              wrapper.appendChild(label);
                                              optionsDiv.appendChild(wrapper);
                                              
                                              radio.addEventListener('change', updatePrefilledUrl);
                                          });
                                          
                                          rowDiv.appendChild(optionsDiv);
                                          inputElement.appendChild(rowDiv);
                                      });
                                      break;

                                  case 'GRID_CHECKBOX': // 核取方格
                                          inputElement = document.createElement('div');
                                          inputElement.className = 'grid-group checkbox-grid';  // 添加特殊類名以便識別
                                          field.rows.forEach(row => {
                                              const rowDiv = document.createElement('div');
                                              rowDiv.className = 'grid-row';
                                              
                                              const rowLabel = document.createElement('div');
                                              rowLabel.className = 'grid-row-label';
                                              rowLabel.textContent = row.title;
                                              rowDiv.appendChild(rowLabel);
                                              
                                              const optionsDiv = document.createElement('div');
                                              optionsDiv.className = 'grid-options';
                                              
                                              field.rows[0].options.forEach(option => {
                                                  const wrapper = document.createElement('div');
                                                  wrapper.className = 'grid-option';
                                                  
                                                  const checkbox = document.createElement('input');
                                                  checkbox.type = 'checkbox';  // 確保使用 checkbox 類型
                                                  checkbox.name = 'entry.' + row.id;
                                                  checkbox.value = option;
                                                  checkbox.id = `grid-${row.id}-${option}`;
                                                  
                                                  const label = document.createElement('label');
                                                  label.htmlFor = checkbox.id;
                                                  label.textContent = option;
                                                  
                                                  wrapper.appendChild(checkbox);
                                                  wrapper.appendChild(label);
                                                  optionsDiv.appendChild(wrapper);
                                                  
                                                  checkbox.addEventListener('change', updatePrefilledUrl);
                                              });
                                              
                                              rowDiv.appendChild(optionsDiv);
                                              inputElement.appendChild(rowDiv);
                                          });
                                          break;

                                          case 'DATE_TIME':
                                              inputElement = document.createElement('div');
                                              inputElement.className = 'datetime-group';
                                              inputElement.setAttribute('data-entry-id', 'entry.' + field.id); 
                                              
                                              // 日期輸入
                                              const dateInput = document.createElement('input');
                                              dateInput.type = 'date';
                                              dateInput.className = 'answer-input';
                                              dateInput.addEventListener('change', updatePrefilledUrl); // 添加這行
                                              inputElement.appendChild(dateInput);
                                              
                                              if (field.includesTime) {
                                                  // 時間輸入
                                                  const timeContainer = document.createElement('div');
                                                  timeContainer.className = 'time-container';
                                                  
                                                  const hourInput = document.createElement('input');
                                                  hourInput.type = 'text';
                                                  hourInput.placeholder = '時';
                                                  hourInput.className = 'time-input';
                                                  hourInput.maxLength = 2;
                                                  
                                                  const minuteInput = document.createElement('input');
                                                  minuteInput.type = 'text';
                                                  minuteInput.placeholder = '分';
                                                  minuteInput.className = 'time-input';
                                                  minuteInput.maxLength = 2;
                                                  
                                                  const ampmSelect = document.createElement('select');
                                                  ampmSelect.className = 'ampm-select';
                                                  ['AM', 'PM'].forEach(period => {
                                                      const option = document.createElement('option');
                                                      option.value = period;
                                                      option.text = period;
                                                      ampmSelect.appendChild(option);
                                                  });
                                                  hourInput.addEventListener('input', updatePrefilledUrl);
                                                  minuteInput.addEventListener('input', updatePrefilledUrl);
                                                  ampmSelect.addEventListener('change', updatePrefilledUrl);
                                                  timeContainer.appendChild(hourInput);
                                                  timeContainer.appendChild(document.createTextNode(':'));
                                                  timeContainer.appendChild(minuteInput);
                                                  timeContainer.appendChild(ampmSelect);
                                                  
                                                  inputElement.appendChild(timeContainer);
                                              }
                                              break;

                                          case 'TIME':
                                              inputElement = document.createElement('div');
                                              inputElement.className = 'time-group';
                                              inputElement.setAttribute('data-entry-id', 'entry.' + field.id);
                                              
                                              const timeHourInput = document.createElement('input');
                                              timeHourInput.type = 'text';
                                              timeHourInput.placeholder = '時';
                                              timeHourInput.className = 'time-input';
                                              timeHourInput.maxLength = 2;
                                              
                                              const timeMinuteInput = document.createElement('input');
                                              timeMinuteInput.type = 'text';
                                              timeMinuteInput.placeholder = '分';
                                              timeMinuteInput.className = 'time-input';
                                              timeMinuteInput.maxLength = 2;
                                              
                                              const timeAmpmSelect = document.createElement('select');
                                              timeAmpmSelect.className = 'ampm-select';
                                              ['AM', 'PM'].forEach(period => {
                                                  const option = document.createElement('option');
                                                  option.value = period;
                                                  option.text = period;
                                                  timeAmpmSelect.appendChild(option);
                                              });
                                              timeHourInput.addEventListener('input', updatePrefilledUrl);
                                              timeMinuteInput.addEventListener('input', updatePrefilledUrl);
                                              timeAmpmSelect.addEventListener('change', updatePrefilledUrl);

                                              inputElement.appendChild(timeHourInput);
                                              inputElement.appendChild(document.createTextNode(':'));
                                              inputElement.appendChild(timeMinuteInput);
                                              inputElement.appendChild(timeAmpmSelect);
                                              break;


                              default: // TEXT
                                  inputElement = document.createElement('input');
                                  inputElement.type = 'text';
                                  inputElement.className = 'answer-input';
                                  inputElement.placeholder = '請輸入答案...';
                                  break;
                          }
                          
                          // 設置共同屬性
                          inputElement.setAttribute('data-entry-id', 'entry.' + field.id);
                          if (inputElement.tagName !== 'DIV') { // 不是 radio 或 checkbox 群組
                              inputElement.addEventListener('input', updatePrefilledUrl);
                          }
                          inputElement.addEventListener('change', updatePrefilledUrl);
                          
                          answerCell.appendChild(inputElement);
                          titleCell.textContent = field.title;
                          
                          // 創建可點擊複製的ID單元格
                          var idDiv = document.createElement('div');
                          idDiv.className = 'entry-id-cell';
                          idDiv.textContent = 'entry.' + field.id;
                          idDiv.addEventListener('click', function(e) {
                              navigator.clipboard.writeText(e.target.textContent).then(function() {
                                  e.target.classList.add('copied');
                                  setTimeout(function() {
                                      e.target.classList.remove('copied');
                                  }, 1000);
                                  showCopyNotification();
                              });
                          });
                          idCell.appendChild(idDiv);
                          
                          requiredCell.textContent = field.required ? "是" : "否";
                      });
                      
                      document.getElementById('prefilledUrlContainer').style.display = 'block';
                      updatePrefilledUrl();
                  } else {
                      table.style.display = "none";
                      document.getElementById("結果顯示區").innerHTML = 
                          '<p style="padding: 20px; color: #d93025;">' + fields + '</p>';
                  }
              }
         

                function updatePrefilledUrl() {
                    let baseUrl = originalFormUrl;
                    baseUrl = baseUrl.split('?')[0];
                    
                    if (baseUrl.includes('/edit')) {
                        baseUrl = baseUrl.replace('/edit', '/viewform');
                    }
                    if (!baseUrl.includes('/viewform')) {
                        baseUrl += '/viewform';
                    }
                    
                    baseUrl = baseUrl.replace('?usp=sf_link', '').replace('&usp=sf_link', '');
                    
                    const params = [];
                    
                    document.querySelectorAll('[data-entry-id]').forEach(element => {
                        const entryId = element.getAttribute('data-entry-id');
                        
                        if (element.classList.contains('datetime-group')) {
                            const dateInput = element.querySelector('input[type="date"]');
                            const timeInputs = element.querySelectorAll('.time-input');
                            const ampmSelect = element.querySelector('.ampm-select');
                            
                            if (dateInput && dateInput.value) {
                                const date = new Date(dateInput.value);
                                const formattedDate = `${date.getMonth() + 1}/${date.getDate()}/${date.getFullYear()}`;
                                
                                let value = formattedDate;
                                if (timeInputs.length === 2 && timeInputs[0].value && timeInputs[1].value) {
                                    value += ` ${timeInputs[0].value}:${timeInputs[1].value} ${ampmSelect.value}`;
                                }
                                params.push(`${entryId}=${encodeURIComponent(value)}`);
                            }
                        } else if (element.classList.contains('time-group')) {
                            const timeInputs = element.querySelectorAll('.time-input');
                            const ampmSelect = element.querySelector('.ampm-select');
                            
                            if (timeInputs.length === 2 && timeInputs[0].value && timeInputs[1].value) {
                                const value = `${timeInputs[0].value}:${timeInputs[1].value} ${ampmSelect.value}`;
                                params.push(`${entryId}=${encodeURIComponent(value)}`);
                            }
                        } else if (element.classList.contains('grid-group')) {
                            element.querySelectorAll('.grid-row').forEach(row => {
                                const inputs = row.querySelectorAll('input:checked');
                                inputs.forEach(input => {
                                    params.push(`${input.name}=${encodeURIComponent(input.value)}`);
                                });
                            });
                        } else if (element.classList.contains('checkbox-group')) {
                            const checkedBoxes = element.querySelectorAll('input[type="checkbox"]:checked');
                            checkedBoxes.forEach(checkbox => {
                                params.push(`${entryId}=${encodeURIComponent(checkbox.value)}`);
                            });
                        } else if (element.classList.contains('radio-group')) {
                            const checkedRadio = element.querySelector('input[type="radio"]:checked');
                            if (checkedRadio) {
                                params.push(`${entryId}=${encodeURIComponent(checkedRadio.value)}`);
                            }
                        } else if (element.value) {
                            params.push(`${entryId}=${encodeURIComponent(element.value)}`);
                        }
                    });
                    
                    const prefilledUrl = params.length > 0 
                        ? `${baseUrl}?${params.join('&')}`
                        : baseUrl;
                    
                    document.getElementById('prefilledUrl').textContent = prefilledUrl;
                }



          function copyPrefilledUrl() {
              const prefilledUrl = document.getElementById('prefilledUrl').textContent;
              navigator.clipboard.writeText(prefilledUrl).then(() => {
                  showCopyNotification();
              });
          }
          
          function showCopyNotification() {
              const notification = document.getElementById('copyNotification');
              notification.style.display = 'block';
              notification.style.animation = 'none';
              notification.offsetHeight;
              notification.style.animation = 'fadeInOut 2s ease-in-out';
              
              setTimeout(() => {
                  notification.style.display = 'none';
              }, 2000);
          }
      </script>
  </body>
  </html>